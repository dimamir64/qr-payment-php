name: PHPUNIT

on: [push, pull_request]

jobs:
    phpunit:
        runs-on: ubuntu-latest

        steps:
        - uses: actions/checkout@v2

        - name: Add HTTP basic auth credentials
          run: echo '${{ secrets.COMPOSER_AUTH_JSON }}' > $GITHUB_WORKSPACE/auth.json

        - uses: php-actions/composer@v6 # or alternative dependency management
          name: Installing composer with deps
          with:
              php_extensions: gd
              php_version: 7.4
              version: 2

        - uses: php-actions/phpunit@v3
          name: Running PHPUNIT
          with:
              php_version: 7.4
              version: 8.5

        - name: Remove auth.json file
          run: rm -f $GITHUB_WORKSPACE/auth.json
